-- Dezactiveaz? schema FDBO în ORDS (cur??are)
BEGIN
    ORDS.ENABLE_SCHEMA(p_enabled => FALSE);
    ORDS.DROP_REST_FOR_SCHEMA;
    COMMIT;
END;
/

-- Activeaz? schema FDBO în ORDS
BEGIN
    ORDS.ENABLE_SCHEMA(
        p_enabled => TRUE,
        p_schema => 'FDBO',
        p_url_mapping_type => 'BASE_PATH',
        p_url_mapping_pattern => 'fdbo',
        p_auto_rest_auth => FALSE
    );
    COMMIT;
END;
/

-- Activeaz? REST pentru fiecare VIEW OLAP
BEGIN
    -- COMBINED views
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_01_MEDICATION_COST_RATING', 'VIEW', 'OLAP_COMBINED_01_MEDICATION_COST_RATING', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_02_DOCTOR_HOSPITAL_STATS', 'VIEW', 'OLAP_COMBINED_02_DOCTOR_HOSPITAL_STATS', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_03_PATIENT_RISK_STATS', 'VIEW', 'OLAP_COMBINED_03_PATIENT_RISK_STATS', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_04_DISEASE_SYMPTOMS_TREATMENT', 'VIEW', 'OLAP_COMBINED_04_DISEASE_SYMPTOMS_TREATMENT', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_04_TREATMENT_COSTS_STATS', 'VIEW', 'OLAP_COMBINED_04_TREATMENT_COSTS_STATS', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_05_INSURANCE_COVERAGE_STATS', 'VIEW', 'OLAP_COMBINED_05_INSURANCE_COVERAGE_STATS', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_05_PATIENT_DISTRIBUTION_STATS', 'VIEW', 'OLAP_COMBINED_05_PATIENT_DISTRIBUTION_STATS', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_06_SYMPTOMS_CATEGORY_OVERVIEW', 'VIEW', 'OLAP_COMBINED_06_SYMPTOMS_CATEGORY_OVERVIEW', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_08_MEDICATION_RATING_PIVOT', 'VIEW', 'OLAP_COMBINED_08_MEDICATION_RATING_PIVOT', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_09_AVG_RATING_BY_DISEASE_PIVOT', 'VIEW', 'OLAP_COMBINED_09_AVG_RATING_BY_DISEASE_PIVOT', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_10_COSTS_ROLLUP_GROUPING', 'VIEW', 'OLAP_COMBINED_10_COSTS_ROLLUP_GROUPING', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_11_PATIENTS_BY_CATEGORY', 'VIEW', 'OLAP_COMBINED_11_PATIENTS_BY_CATEGORY', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_12_COST_RATING_CATEGORY_ROLLUP', 'VIEW', 'OLAP_COMBINED_12_COST_RATING_CATEGORY_ROLLUP', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_COMBINED_15_DISEASES_BY_DATE_PARTS', 'VIEW', 'OLAP_COMBINED_15_DISEASES_BY_DATE_PARTS', FALSE);

    -- EXCEL, MONGODB, ORACLE, POSTGRES
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_EXCEL_01_INSURANCE_ROLLUP', 'VIEW', 'OLAP_EXCEL_01_INSURANCE_ROLLUP', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_MONGODB_01_RISK_FACTORS_BY_DISEASE', 'VIEW', 'OLAP_MONGODB_01_RISK_FACTORS_BY_DISEASE', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_ORACLE_01_TOP_MEDICATIONS', 'VIEW', 'OLAP_ORACLE_01_TOP_MEDICATIONS', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_POSTGRES_01_DISEASE_CUBE', 'VIEW', 'OLAP_POSTGRES_01_DISEASE_CUBE', FALSE);

    -- Diverse analize
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_GROUPING_SETS_TREATMENTS', 'VIEW', 'OLAP_GROUPING_SETS_TREATMENTS', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_LISTAGG_MEDICATIONS_BY_DISEASE', 'VIEW', 'OLAP_LISTAGG_MEDICATIONS_BY_DISEASE', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_PERCENT_COST_DISTRIBUTION', 'VIEW', 'OLAP_PERCENT_COST_DISTRIBUTION', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_RATING_STDDEV_BY_DISEASE', 'VIEW', 'OLAP_RATING_STDDEV_BY_DISEASE', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_TREATMENT_COST_EVOLUTION', 'VIEW', 'OLAP_TREATMENT_COST_EVOLUTION', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_TREATMENT_RATING_TREND', 'VIEW', 'OLAP_TREATMENT_RATING_TREND', FALSE);
    ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'OLAP_UNPIVOT_PATIENT_DETAILS', 'VIEW', 'OLAP_UNPIVOT_PATIENT_DETAILS', FALSE);

    COMMIT;
END;
/




BEGIN
  -- Dezactivare REST existent (opțional)
  ORDS.ENABLE_SCHEMA(p_enabled => FALSE);
  ORDS.DROP_REST_FOR_SCHEMA();
  COMMIT;
END;
/

BEGIN
  -- Re-activare schema
  ORDS.ENABLE_SCHEMA(
    p_enabled => TRUE,
    p_schema => 'FDBO',
    p_url_mapping_type => 'BASE_PATH',
    p_url_mapping_pattern => 'fdbo',
    p_auto_rest_auth => FALSE
  );
  COMMIT;
END;
/

-- Activare REST pentru view-urile simple/intermediare
BEGIN
  -- View-uri de analiză sau intermediare
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'PATIENTS_VIEW', 'VIEW', 'PATIENTS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'SYMPTOMS_VIEW', 'VIEW', 'SYMPTOMS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'DIAGNOSES_VIEW', 'VIEW', 'DIAGNOSES_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'DISEASES_VIEW', 'VIEW', 'DISEASES_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'DOCTORS_VIEW', 'VIEW', 'DOCTORS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'HOSPITAL_RESOURCES_VIEW', 'VIEW', 'HOSPITAL_RESOURCES_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'INSURANCE_COVERAGE_VIEW', 'VIEW', 'INSURANCE_COVERAGE_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'MEDICATION_REVIEWS_VIEW', 'VIEW', 'MEDICATION_REVIEWS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'MEDICATIONS_VIEW', 'VIEW', 'MEDICATIONS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'TREATMENT_COSTS_VIEW', 'VIEW', 'TREATMENT_COSTS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'TREATMENTS_VIEW', 'VIEW', 'TREATMENTS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'TREATMENTS_AGG_VIEW', 'VIEW', 'TREATMENTS_AGG_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'RISK_FACTORS_VIEW', 'VIEW', 'RISK_FACTORS_VIEW', FALSE);

  -- View-uri de query 1-17
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY1_PATIENTS_SYMPTOMS_VIEW', 'VIEW', 'QUERY1_PATIENTS_SYMPTOMS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY2_PATIENT_REVIEWS_VIEW', 'VIEW', 'QUERY2_PATIENT_REVIEWS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY3_DOCTOR_HOSPITAL_VIEW', 'VIEW', 'QUERY3_DOCTOR_HOSPITAL_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY4_PATIENT_DOCTOR_DISEASE_VIEW', 'VIEW', 'QUERY4_PATIENT_DOCTOR_DISEASE_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY5_PATIENT_SYMPTOMS_FACTORS_VIEW', 'VIEW', 'QUERY5_PATIENT_SYMPTOMS_FACTORS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY6_INSURANCE_PER_DISEASE_VIEW', 'VIEW', 'QUERY6_INSURANCE_PER_DISEASE_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY7_TREATMENT_COST_REVIEW_VIEW', 'VIEW', 'QUERY7_TREATMENT_COST_REVIEW_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY8_DISEASE_DIAGNOSE_COUNT_VIEW', 'VIEW', 'QUERY8_DISEASE_DIAGNOSE_COUNT_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY9_TOP_TREATMENTS_VIEW', 'VIEW', 'QUERY9_TOP_TREATMENTS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY10_HOSPITAL_RESOURCES_VIEW', 'VIEW', 'QUERY10_HOSPITAL_RESOURCES_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY12_TREATMENT_COUNT_VIEW', 'VIEW', 'QUERY12_TREATMENT_COUNT_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY14_DISEASE_DISTRIBUTION_VIEW', 'VIEW', 'QUERY14_DISEASE_DISTRIBUTION_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY15_DISEASE_TIMELINE_VIEW', 'VIEW', 'QUERY15_DISEASE_TIMELINE_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY16_COMMON_SYMPTOMS_VIEW', 'VIEW', 'QUERY16_COMMON_SYMPTOMS_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'QUERY17_PATIENTS_WITH_RISK_AND_SYMPTOMS', 'VIEW', 'QUERY17_PATIENTS_WITH_RISK_AND_SYMPTOMS', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'PATIENTS_WITH_DISEASE_VIEW', 'VIEW', 'PATIENTS_WITH_DISEASE_VIEW', FALSE);
  ORDS.ENABLE_OBJECT(TRUE, 'FDBO', 'PATIENTS_WITH_REVIEWS_VIEW', 'VIEW', 'PATIENTS_WITH_REVIEWS_VIEW', FALSE);

  COMMIT;
END;
/

